<!DOCTYPE html>
<html>

<head>
    <title>OECD Municipal Atlas</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

    <!-- Load Esri Leaflet from CDN -->
    <script src="https://unpkg.com/esri-leaflet@3.0.10/dist/esri-leaflet.js"></script>
    <script src="https://unpkg.com/esri-leaflet-vector@4.1.0/dist/esri-leaflet-vector.js"></script>
    
    <!-- load VectorGrid extension -->
    <script src="https://unpkg.com/leaflet.vectorgrid@1.3.0/dist/Leaflet.VectorGrid.bundled.js"></script> 

    <!-- load Geotiff extension -->
    <!-- <script src="https://unpkg.com/georaster"></script> -->
    <script src="https://unpkg.com/chroma-js"></script>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="fontawesome/css/brands.css">
    <link rel="stylesheet" href="fontawesome/css/fontawesome.css">
    <link rel="stylesheet" href="fontawesome/css/regular.css">
    <script src="https://unpkg.com/leaflet-geosearch@3.1.0/dist/bundle.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet-geosearch@3.1.0/dist/geosearch.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <script src="https://www.unpkg.com/papaparse@5.4.1/papaparse.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0-rc.0/css/select2.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0-rc.0/js/select2.min.js"></script>


</head>

<body class="min-h-screen bg-white">
    <div id="app" data-v-app="">

        <div class="relative flex min-h-screen flex-col bg-white">
            <nav class="top-0 border-b border-gray-200 bg-gray-100 sm:sticky sm:z-20 sm:shadow-lg print:!hidden">
                <!-- <div class="ml-auto max-w-7xl px-4 sm:px-6 lg:px-8">
                    <div class="flex h-16 items-center justify-start"> -->
                <div class="mx-auto max-w-1xl px-4 sm:px-6 lg:px-8">
                    <div class="flex h-16 items-center justify-between">
                        <div class="flex items-center">
                            <a class="flex shrink-0 items-center mr-4 ml-0">
                                <img src="img/OECD_logo_new.svg.png" class="h-8 sm:h-10 w-auto" />
                            </a>
                            <div class="font-bold text-xl sm:text-2xl text-gray-700 hidden sm:flex" style="padding: 20px;">
                                Municipal Atlas
                            </div>
                        </div>
                        
                        
                        <div class=" sm:-my-px sm:flex sm:space-x-4 justify-between items-center">
                            <a href="index"
                            class="!text-gray-900 router-link-exact-active inline-flex items-center px-1 font-bold text-gray-500 hover:text-gray-700"
                            aria-current="page">Maps</a>
                            <a href="profile"
                            class="inline-flex items-center px-1 font-bold text-gray-500 hover:text-gray-700">Profile</a>
                            <a href="methodology"
                            class="inline-flex items-center px-1 font-bold text-gray-500 hover:text-gray-700">Methodology</a>
                        </div>
                    
                    </div>
                </div>
            </nav>
            <div class="grow">
                <div class="relative flex h-[calc(100vh-3.5rem-1px)] flex-col sm:flex-row">
                    <div
                        class="z-10 flex w-full shrink-0 flex-col gap-12 overflow-auto border-gray-200 bg-white py-5 px-4 sm:z-10 sm:flex sm:w-[380px] sm:border-r sm:px-6 xl:w-[460px] hidden sm:flex">
                        
                        <div class="flex flex-col gap-5">
                            <div class="flex items-center gap-2">
                                <div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-shift-indigo text-xl text-white"
                                    style="background: rgb(178, 82, 144);"><i
                                        class="fa-fw fa-regular fa-people"></i>
                                    </div>
                                <div class="text-lg font-bold">Demography</div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                    style="background: rgb(178, 82, 144);"><i
                                        class="fa-fw fa-regular fa-person"></i></div>
                                <div class="font-bold">Population size</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-pop-tot">
                                        <div class="font-medium text-gray-600" >Total population </div><!---->
                                    </div>
                                    
                                </div>
                                
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                    style="background: rgb(178, 82, 144);"><i
                                        class="fa-fw fa-regular fa-person-cane"></i></div>
                                <div class="font-bold">Age groups</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-youngsh">
                                        <div class="font-medium text-gray-600" >Share of young population (- 14 years old) </div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-workagesh">
                                        <div class="font-medium text-gray-600">Share of working age population (15 to 64 years old)</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-oldsh">
                                        <div class="font-medium text-gray-600">Share of elderly population (+ 65 years old)</div><!---->
                                    </div>
                                </div>
                                
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                    style="background: rgb(178, 82, 144);"><i
                                        class="fa-fw fa-regular fa-venus-mars"></i></div>
                                <div class="font-bold">Sex ratio</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-sex-ratio">
                                        <div class="font-medium text-gray-600" >Sex ratio (total population)</div><!---->
                                    </div>
                                    
                                </div>
                                
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: rgb(178, 82, 144);"><i
                                            class="fa-fw fa-regular fa-chart-line-up"></i></div>
                                    <div class="font-bold">Population change</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-popch">
                                        <div class="font-medium text-gray-600" >Population change in the last 5 years</div><!---->
                                    </div>
                                </div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: rgb(178, 82, 144);"><i
                                            class="fa-fw fa-regular fa-baby"></i></div>
                                    <div class="font-bold">Natural change</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-natch">
                                        <div class="font-medium text-gray-600" >Natural change in the last 5 years</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-birth">
                                        <div class="font-medium text-gray-600" >Birth rate</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-death">
                                        <div class="font-medium text-gray-600" >Death rate</div><!---->
                                    </div>
                                    
                                </div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: rgb(178, 82, 144);"><i
                                            class="fa-fw fa-regular fa-globe"></i></div>
                                    <div class="font-bold">Migration</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-foreign-born">
                                        <div class="font-medium text-gray-600" >Share of foreign-born population</div><!---->
                                    </div>
                                    
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-netmobmig">
                                        <div class="font-medium text-gray-600" >Net migration rate (internal and international)</div><!---->
                                    </div>
                                    
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-netmob">
                                        <div class="font-medium text-gray-600" >Net internal migration rate</div><!---->
                                    </div>
                                    
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-netmig">
                                        <div class="font-medium text-gray-600" >Net international migration rate</div><!---->
                                    </div>
                                    
                                </div>

                            </div>
                        </div>
                        <div class="flex flex-col gap-5">
                            <div class="flex items-center gap-2">
                                <div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-shift-indigo text-xl text-white"
                                    style="background: rgb(16, 149, 76);"><i class="fa-fw fa-regular fa-seedling"></i>
                                </div>
                                <div class="text-lg font-bold">Environment</div>
                            </div>
                            
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: rgb(16, 149, 76);"><i
                                            class="fa-fw fa-regular fa-seedling"></i></div>
                                    <div class="font-bold">Green areas</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-green-sh">
                                        <div class="font-medium text-gray-600">Share of green areas</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-green-capita">
                                        <div class="font-medium text-gray-600"> Green areas per capita</div><!---->
                                    </div>
                                </div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: rgb(16, 149, 76);"><i
                                            class="fa-fw fa-regular fa-trees"></i></div>
                                    <div class="font-bold">Tree cover change</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-forestch">
                                        <div class="font-medium text-gray-600">Tree cover change 2000-2020</div><!---->
                                    </div>
                                   
                                </div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: rgb(16, 149, 76);"><i
                                            class="fa-fw fa-regular fa-wind-turbine"></i></div>
                                    <div class="font-bold">Renewable potential</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-solar-power">
                                        <div class="font-medium text-gray-600">Solar power potential</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-wind-power">
                                        <div class="font-medium text-gray-600"> Wind power potential</div><!---->
                                    </div>
                                </div>
                            </div>
                            <!-- <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: rgb(16, 149, 76);"><i
                                            class="fa-fw fa-regular fa-smog"></i></div>
                                    <div class="font-bold">Air pollution</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-no2">
                                        <div class="font-medium text-gray-600">NO<sub>2</sub></div>
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-pm25">
                                        <div class="font-medium text-gray-600">PM2.5</div>
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-pm10">
                                        <div class="font-medium text-gray-600">PM10</div>
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-o3">
                                        <div class="font-medium text-gray-600">O<sub>3</sub></div>
                                    </div>
                                </div>
                            </div> -->

                        </div>
                        <div class="flex flex-col gap-5">
                            <div class="flex items-center gap-2">
                                <div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-shift-indigo text-xl text-white"
                                    style="background: darkred;"><i class="fa-fw fa-regular fa-temperature-arrow-up"></i>
                                </div>
                                <div class="text-lg font-bold">Climate</div>
                            </div>
                            
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: darkred;"><i
                                            class="fa-fw fa-regular fa-temperature-arrow-up"></i></div>
                                    <div class="font-bold">Temperature trends</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-temp">
                                        <div class="font-medium text-gray-600" >Air temperature</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-temp-ch">
                                        <div class="font-medium text-gray-600" >Change in air temperature compared to 1981-2010</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-lst-day">
                                        <div class="font-medium text-gray-600" >Daytime summer land surface temperature</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-lst-night">
                                        <div class="font-medium text-gray-600" >Nighttime summer land surface temperature
                                        </div><!---->
                                    </div>
                                    
                                </div>
                            </div>

                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: darkred;"><i
                                            class="fa-fw fa-regular fa-temperature-sun"></i></div>
                                    <div class="font-bold">Heat stress</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-hot-days">
                                        <div class="font-medium text-gray-600" >Hot days (T<sub>max</sub> > 35째C)</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-hot-days-ch">
                                        <div class="font-medium text-gray-600" >Change in hot days (T<sub>max</sub> > 35째C) compared to 1981-2010</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-tropical-nights">
                                        <div class="font-medium text-gray-600" >Tropical nights (T<sub>min</sub> > 20째C)</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-tropical-nights-ch">
                                        <div class="font-medium text-gray-600" >Change in tropical nights (T<sub>min</sub> > 20째C) compared to 1981-2010</div><!---->
                                    </div>
                                    
                                </div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: darkred;"><i
                                            class="fa-fw fa-regular fa-fan"></i></div>
                                    <div class="font-bold">Cooling degree days</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-cdd">
                                        <div class="font-medium text-gray-600" >Cooling degree days in the last 5 years</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-cdd-ch">
                                        <div class="font-medium text-gray-600" >Change in cooling degree days compared to 1981-2010
                                        </div><!---->
                                    </div>
                                </div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: darkred;"><i
                                            class="fa-fw fa-regular fa-heat"></i></div>
                                    <div class="font-bold">Heating degree days</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-hdd">
                                        <div class="font-medium text-gray-600" >Heating degree days in the last 5 years</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-hdd-ch">
                                        <div class="font-medium text-gray-600" >Change in heating degree days compared to 1981-2010
                                        </div><!---->
                                    </div>
                                </div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: darkred;"><i
                                            class="fa-fw fa-regular fa-cloud-showers-heavy"></i></div>
                                    <div class="font-bold">Precipitation</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-precip">
                                        <div class="font-medium text-gray-600" >Average precipitation</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-precip-ch">
                                        <div class="font-medium text-gray-600" >Average precipitation change compared to 1981-2010</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-ext-precip">
                                        <div class="font-medium text-gray-600" >Extreme precipitation days</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-ext-precip-ch">
                                        <div class="font-medium text-gray-600" >Extreme precipitation days change compared to 1981-2010</div><!---->
                                    </div>
                                </div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: darkred;"><i
                                            class="fa-fw fa-regular fa-sun-plant-wilt"></i></div>
                                    <div class="font-bold">Droughts</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-drought">
                                        <div class="font-medium text-gray-600">Soil moisture change compared to 1981-2010</div><!---->
                                    </div>
                                </div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: darkred;"><i
                                            class="fa-fw fa-regular fa-fire"></i></div>
                                    <div class="font-bold">Fires</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-fire-burned">
                                        <div class="font-medium text-gray-600">Share of area burned</div><!---->
                                    </div>
                                </div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: darkred;"><i
                                            class="fa-fw fa-regular fa-house-flood-water"></i></div>
                                    <div class="font-bold">River flooding</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-river-flood">
                                        <div class="font-medium text-gray-600">Share of population exposed to 100-year river flooding</div><!---->
                                    </div>
                                </div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: darkred;"><i
                                            class="fa-fw fa-regular fa-house-tsunami"></i></div>
                                    <div class="font-bold">Coastal flooding</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-coastal-flood">
                                        <div class="font-medium text-gray-600">Share of population exposed to 100-year coastal flooding</div><!---->
                                 </div>
                                </div>
                            </div> 
                            
                        </div>

                        <div class="flex flex-col gap-5">
                            <div class="flex items-center gap-2">
                                <div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-shift-indigo text-xl text-white"
                                    style="background: rgb(77, 82, 168);"><i
                                        class="fa-fw fa-regular fa-building-columns"></i>
                                    </div>
                                <div class="text-lg font-bold">Economy and labour</div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                    style="background: rgb(77, 82, 168);"><i
                                        class="fa-fw fa-regular fa-dollar-sign"></i></div>
                                <div class="font-bold">Income distribution</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-median-income">
                                        <div class="font-medium text-gray-600">Median disposable income</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-poverty">
                                        <div class="font-medium text-gray-600">Relative poverty rate (60% of median income)</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-gini">
                                        <div class="font-medium text-gray-600" >Gini coefficient</div><!---->
                                    </div>
                                </div>
                                
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                    style="background: rgb(77, 82, 168);"><i
                                        class="fa-fw fa-regular fa-briefcase"></i></div>
                                <div class="font-bold">Labour</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-unempl-rate">
                                        <div class="font-medium text-gray-600" >Unemployment rate</div><!---->
                                    </div>
                                
                                </div>
                                
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: rgb(77, 82, 168);"><i
                                            class="fa-fw fa-regular fa-house"></i></div>
                                    <div class="font-bold">Housing</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-rent">
                                        <div class="font-medium text-gray-600" >Rent per sq. m</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-housing-price">
                                        <div class="font-medium text-gray-600">Price per sq. m</div><!---->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="flex flex-col gap-5">
                            <div class="flex items-center gap-2">
                                <div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-shift-indigo text-xl text-white"
                                    style="background: rgb(122, 64, 43);"><i
                                        class="fa-fw fa-regular fa-building-user"></i>
                                    </div>
                                <div class="text-lg font-bold">Territorial organisation</div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                    style="background: rgb(122, 64, 43);"><i
                                        class="fa-fw fa-regular fa-person-arrow-up-from-line"></i></div>
                                <div class="font-bold">Population density</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-pop-dens">
                                        <div class="font-medium text-gray-600">Population density</div><!---->
                                    </div>
                                </div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                    style="background: rgb(122, 64, 43);"><i
                                        class="fa-fw fa-regular fa-square"></i></div>
                                <div class="font-bold">Built-up surface</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-builts-dens">
                                        <div class="font-medium text-gray-600" >Built-up surface per capita</div><!---->
                                    </div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-res-builts-dens">
                                        <div class="font-medium text-gray-600" >Residential built-up surface per capita</div><!---->
                                    </div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-nres-builts-dens">
                                        <div class="font-medium text-gray-600" >Non-residential built-up surface per capita</div><!---->
                                    </div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-builts-gr">
                                        <div class="font-medium text-gray-600" >Built-up surface growth 2000-2020</div><!---->
                                    </div>
                                </div>
                                
                            </div>

                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                    style="background: rgb(122, 64, 43);"><i
                                        class="fa-fw fa-regular fa-cube"></i></div>
                                <div class="font-bold">Built-up volume</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-builtv-dens">
                                        <div class="font-medium text-gray-600" >Built-up volume per capita</div><!---->
                                    </div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-res-builtv-dens">
                                        <div class="font-medium text-gray-600" >Residential built-up volume per capita</div><!---->
                                    </div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-nres-builtv-dens">
                                        <div class="font-medium text-gray-600" >Non-residential built-up volume per capita</div><!---->
                                    </div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-builth">
                                        <div class="font-medium text-gray-600" >Average building height</div><!---->
                                    </div>
                                </div>
                                
                            </div>

                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                    style="background: rgb(122, 64, 43);"><i
                                        class="fa-fw fa-regular fa-tree-city"></i></div>
                                <div class="font-bold">Degree of urbanisation</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-degurba-l1">
                                        <div class="font-medium text-gray-600">Level 1</div><!---->
                                    </div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-degurba-l2">
                                        <div class="font-medium text-gray-600">Level 2</div><!---->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="flex flex-col gap-5">
                            <div class="flex items-center gap-2">
                                <div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-shift-indigo text-xl text-white"
                                    style="background: rgb(255, 130, 0);"><i class="fa-fw fa-regular fa-shop"></i>
                                </div>
                                <div class="text-lg font-bold">Services</div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <div class="flex items-start gap-2">
                                    <div class="flex h-6 w-6 items-center justify-center rounded-full text-xs text-white"
                                        style="background: rgb(255, 130, 0);"><i
                                            class="fa-fw fa-regular fa-wifi"></i></div>
                                    <div class="font-bold">Digitalisation</div>
                                </div>
                                <div class="flex flex-col gap-2">
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-download">
                                        <div class="font-medium text-gray-600">Download speed</div><!---->
                                    </div>
                                    <div
                                        class="cursor-pointer justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm shadow-sm hover:bg-gray-50"
                                        id="button-upload">
                                        <div class="font-medium text-gray-600">Upload speed</div><!---->
                                    </div>
                                </div>
                            </div>
                            
                            
                        </div>
                        
                    </div>

                    <div class="z-10 flex flex-1 flex-col">
                        <div class="absolute inset-0 h-full w-full sm:relative">
                            <div class="h-full w-full transition">
                                <div id="map" class="leaflet-container leaflet-touch leaflet-fade-anim leaflet-grab leaflet-touch-drag leaflet-touch-zoom" style="height: 100%; width: 100%;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
        
    </div>
    
    
</div>

<!-- <div id="map" style="width: 100vw; height: 100vh; background: #fdfdfd"></div> -->

<script  type="text/javascript" src="./js/map.js"></script>

<script>
var currentLayer;
var currentLegend;
var currentButton;
var currentChartControl;
// create map
var map = L.map('map', {
        center: [48.8566, 2.3522],
        minZoom: 3,
        maxZoom: 12,
        zoomControl: true,
        zoom: 7,
});

var fuaData;
fetch('https://municipalatlas.blob.core.windows.net/data/data/data_fua.csv')
  .then(response => response.text())
  .then(csvData => {
    // Parse the CSV data using Papaparse
    fuaData = Papa.parse(csvData, { header: true });
  }
  )

var cityData;
fetch('https://municipalatlas.blob.core.windows.net/data/data/data_city.csv')
  .then(response => response.text())
  .then(csvData => {
    // Parse the CSV data using Papaparse
    cityData = Papa.parse(csvData, { header: true });
  }
  )

var tl1Data;
fetch('https://municipalatlas.blob.core.windows.net/data/data/data_tl1.csv')
  .then(response => response.text())
  .then(csvData => {
    // Parse the CSV data using Papaparse
    fuaData = Papa.parse(csvData, { header: true });
  }
  )

var tl2Data;
fetch('https://municipalatlas.blob.core.windows.net/data/data/data_tl2.csv')
  .then(response => response.text())
  .then(csvData => {
    // Parse the CSV data using Papaparse
    fuaData = Papa.parse(csvData, { header: true });
  }
  )

var tl3Data;
fetch('https://municipalatlas.blob.core.windows.net/data/data/data_tl3.csv')
  .then(response => response.text())
  .then(csvData => {
    // Parse the CSV data using Papaparse
    fuaData = Papa.parse(csvData, { header: true });
  }
  )

var mapBaseLayer = L.esri.Vector.vectorBasemapLayer("8d891c38ed57477aa1db1693c144bab4", {
    apikey: "AAPK6733906110644097bc8da019ac9689e2vgrUl21eT8xUm1vNGb7Ovg7qfyhqoi0Ka0yYuNo7J1ER0XeYWtyHpyy7tr5nNtXk", 
});
mapBaseLayer.addTo(map);

var mapBaseLabelsLayer = L.esri.Vector.vectorBasemapLayer("arcgis/light-gray/labels", {
apikey: "AAPK6733906110644097bc8da019ac9689e2vgrUl21eT8xUm1vNGb7Ovg7qfyhqoi0Ka0yYuNo7J1ER0XeYWtyHpyy7tr5nNtXk", 
zindex: 10,
});
mapBaseLabelsLayer.addTo(map);

var mapBaseTL1PlainUrl = "https://municipalatlas.blob.core.windows.net/tiles/tl1_plain_tiles/{z}/{x}/{y}.pbf";
var mapBaseTL1PlainStyling = {
        "tl1_plain_boundaries": function (properties, zoom) {
            return {
                fill: false, // No fill
                weight: 1,
                color: "#626262", // Black color
                opacity: 1.0,
            };
        }
};
var mapBaseTL1PlainTileOptions = {
    rendererFactory: L.canvas.tile,
    interactive: false,
    maxNativeZoom: 12,
    minZoom: 0,
    vectorTileLayerStyles: mapBaseTL1PlainStyling,
    attribution: "Source of administrative boundaries: National Statistical Offices and FAO Global Administrative Unit Layers (GAUL). This map is for illustrative purposes and is without prejudice to the status of or sovereignty over any territory covered by this map."
};
try {
    var mapBaseTL1PlainLayer = new L.VectorGrid.Protobuf(mapBaseTL1PlainUrl, mapBaseTL1PlainTileOptions);
    mapBaseTL1PlainLayer.setZIndex(12).addTo(map);
} catch (error) {
    // Handle the error here (or ignore it)
    console.error("Error loading PBF file:", error);
}

var mapBaseTL1DottedUrl = "https://municipalatlas.blob.core.windows.net/tiles/tl1_dotted_tiles/{z}/{x}/{y}.pbf";
var mapBaseTL1DottedStyling = {
        "tl1_dotted_boundaries": function (properties, zoom) {
            return {
                fill: false, // No fill
                weight: 1,
                color: "#626262", // Black color
                opacity: 1.0,
                dashArray: "4, 4",
            };
        }
};
var mapBaseTL1DottedTileOptions = {
    rendererFactory: L.canvas.tile,
    interactive: false,
    maxNativeZoom: 12,
    minZoom: 0,
    vectorTileLayerStyles: mapBaseTL1DottedStyling
};
try {
    var mapBaseTL1DottedLayer = new L.VectorGrid.Protobuf(mapBaseTL1DottedUrl, mapBaseTL1DottedTileOptions);
    mapBaseTL1DottedLayer.setZIndex(12).addTo(map);
} catch (error) {
    console.error("Error loading PBF file:", error);
}

var mapBaseTL2Url = "https://municipalatlas.blob.core.windows.net/tiles/tl2_tiles/{z}/{x}/{y}.pbf";
var mapBaseTL2Styling = {
        "tl2_oecd_interior_boundaries": function (properties, zoom) {
            return {
                fill: false, // No fill
                weight: 0.8,
                color: "#626262", // Black color
                opacity: 1.0,
            };
        }
};
var mapBaseTL2TileOptions = {
    rendererFactory: L.canvas.tile,
    interactive: false,
    maxNativeZoom: 12,
    minZoom: 6,
    vectorTileLayerStyles: mapBaseTL2Styling
};
try {
    var mapBaseTL2Layer = new L.VectorGrid.Protobuf(mapBaseTL2Url, mapBaseTL2TileOptions);
} catch (error) {
    console.error("Error loading PBF file:", error);
}

var mapBaseTL3Url = "https://municipalatlas.blob.core.windows.net/tiles/tl3_tiles/{z}/{x}/{y}.pbf";
var mapBaseTL3Styling = {
        "tl3_oecd_interior_boundaries": function (properties, zoom) {
            return {
                fill: false, // No fill
                weight: 0.8,
                color: "#626262", // Black color
                opacity: 1.0,
            };
        }
};
var mapBaseTL3TileOptions = {
    rendererFactory: L.canvas.tile,
    interactive: false,
    maxNativeZoom: 12,
    minZoom: 6,
    vectorTileLayerStyles: mapBaseTL3Styling
};
try {
var mapBaseTL3Layer = new L.VectorGrid.Protobuf(mapBaseTL3Url, mapBaseTL3TileOptions);
} catch (error) {
    console.error("Error loading PBF file:", error);
}

var mapBaseFUAUrl = "https://municipalatlas.blob.core.windows.net/tiles/fuas_tiles/{z}/{x}/{y}.pbf";
var mapBaseFUAStyling = {
        "fuas_oecd_boundaries": function (properties, zoom) {
            return {
                fill: false, // No fill
                weight: 0.8,
                color: "#626262", // Black color
                opacity: 1.0,
            };
        }
};
var mapBaseFUATileOptions = {
    rendererFactory: L.canvas.tile,
    interactive: false,
    maxNativeZoom: 12,
    minZoom: 6,
    vectorTileLayerStyles: mapBaseFUAStyling
};
var mapBaseFUALayer = new L.VectorGrid.Protobuf(mapBaseFUAUrl, mapBaseFUATileOptions);

var mapBaseCityUrl = "https://municipalatlas.blob.core.windows.net/tiles/cities_tiles/{z}/{x}/{y}.pbf";
var mapBaseCityStyling = {
        "cities_oecd_boundaries": function (properties, zoom) {
            return {
                fill: false, // No fill
                weight: 0.8,
                color: "#626262", // Black color
                opacity: 1.0,
            };
        }
};
var mapBaseCityTileOptions = {
    rendererFactory: L.canvas.tile,
    interactive: false,
    maxNativeZoom: 12,
    minZoom: 6,
    vectorTileLayerStyles: mapBaseCityStyling
};
var mapBaseCityLayer = new L.VectorGrid.Protobuf(mapBaseCityUrl, mapBaseCityTileOptions);


var tlLayers = {};
tlLayers['Large regions (TL2)'] = mapBaseTL2Layer;
tlLayers['Small regions (TL3)'] = mapBaseTL3Layer;
tlLayers['Metropolitan areas (FUA)'] = mapBaseFUALayer;
tlLayers['Cities'] = mapBaseCityLayer;

var controlGeoLayers = L.control.layers(tlLayers, null, {
    collapsed: true,
    position: 'topleft'
})
.addTo(map);

tlLayers['Large regions (TL2)'].setZIndex(13).addTo(map); 


createLayerAndLegend("median-income", "MEDIAN_DISP_INC_PC_CURR_PR", "Median disposable income", "", 10000, 50000, [10000, 15000, 20000, 25000, 30000, 35000, 40000, 45000, 50000], scaleBlues, firstLayer=false);
createLayerAndLegend("gini", "GINI", "Gini coefficient", "", 0.2, 0.5, [0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5], scaleBlues, firstLayer=false,  minusLow=true);
createLayerAndLegend("poverty", "POV_RATE_60",  "Poverty rate", "%", 5, 40, [5, 10, 15, 20, 25, 30, 35, 40], scaleBlues, firstLayer=false,  minusLow=true);
createLayerAndLegend("unempl-rate", "UNEMP_RA_15_64", "Unemployment rate", "%", 0, 30, [0, 5, 10, 15, 20, 25, 30], scaleBlues, firstLayer=false);
createLayerAndLegend("rent", "RENT_M2", "Rent", "/m짼", 5, 25, [5, 7.5, 10, 12.5, 15, 17.5, 20, 22.5, 25], scaleBlues, firstLayer=false,  minusLow=true);
createLayerAndLegend("housing-price", "HOUSING_PRICE_M2", "Housing price", "/m짼", 0, 10000, [0, 2000, 6000, 8000, 10000], scaleBlues, firstLayer=false);

createLayerAndLegend("pop-dens", "pop_density_km2", "Population density", "people/km짼", 0, 10000, [0, 1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000, 9000,10000], scaleBrowns, firstLayer=false);
createLayerAndLegend("builts-dens", "BUILT_S__T", "Built-up surface per capita", "m짼/capita", 0, 600, [0, 100, 200, 300, 400, 500, 600], scaleBrowns, firstLayer=false);
createLayerAndLegend("res-builts-dens", "BUILT_S_RES", "Residential built-up surface per capita", "m짼/capita", 0, 600, [0, 100, 200, 300, 400, 500, 600], scaleBrowns, firstLayer=false);
createLayerAndLegend("nres-builts-dens", "BUILT_S_NRES", "Non-residential built-up surface per capita", "m짼/capita", 0, 400, [0, 50, 100, 150, 200, 250, 300, 350, 400], scaleBrowns, firstLayer=false);
createLayerAndLegend("builts-gr", "BUILT_S_CH__T", "Built-up surface growth 2000-2020", "%", -80, 80, [-80, -60, -40, -20, 0, 20, 40, 60, 80], scaleBuRd, firstLayer=false,  minusLow=true);
createLayerAndLegend("builtv-dens", "BUILT_V__T", "Built-up volume per capita", "m쨀/capita", 0, 1500, [0, 300, 600, 900, 1200, 1500], scaleBrowns, firstLayer=false);
createLayerAndLegend("res-builtv-dens", "BUILT_V_RES", "Residential built-up volume per capita", "m쨀/capita", 0, 1500, [0, 300, 600, 900, 1200, 1500], scaleBrowns, firstLayer=false);
createLayerAndLegend("nres-builtv-dens", "BUILT_V_NRES", "Non-residential built-up volume per capita", "m쨀/capita", 0, 1000, [0, 200, 400, 600, 800, 1000], scaleBrowns, firstLayer=false);
createLayerAndLegend("builth", "BUILT_H", "Average building height", "m", 0, 8, [0, 1, 2, 3, 4, 5, 6, 7, 8], scaleBrowns, firstLayer=false);

degurbaL1Colors = {'City': 'cornflowerblue', 
            'Town and semi-dense area': '#ff7f0e', 
            'Rural area': '#2ca02c'};
degurbaL2Colors = {
  'City': 'cornflowerblue', // Blue
  'Dense town': '#FFA500', // Orange
  'Semi-dense town': '#FF8C00', // A different shade of orange
  'Suburban or peri-urban area': '#FF6347', // Yet another shade of orange
  'Village': '#8FB31D', // Green
  'Dispersed rural area': '#77DD77', // A shade of green
  'Mostly uninhabited area': '#0B610B' // Green
};
createLayerAndLegendCategorical("degurba-l1", "DEGURBA_L1", "Degree of urbanisation", degurbaL1Colors);
createLayerAndLegendCategorical("degurba-l2", "DEGURBA_L2", "Degree of urbanisation", degurbaL2Colors);

createLayerAndLegend("pop-tot", "POP_T", "Total population", "", 0, 25000, [0, 5000, 10000, 15000, 20000, 25000], scalePinks, firstLayer=false);
createLayerAndLegend("popch", "POP_CH", "Population change", "%", -30, 30, [-30, -20, -10, 0, 10, 20, 30], scaleRdBu, firstLayer=true, minusLow=false);
createLayerAndLegend("natch", "NETNAT_RATE", "Net natural change rate",  "%", -30, 30, [-30, -20, -10, 0, 10, 20, 30], scaleRdBu, firstLayer=false, minusLow=true);
createLayerAndLegend("netmobmig", "NETMOBMIG_RATE", "Net migration rate",  "%", -30, 30, [-30, -20, -10, 0, 10, 20, 30], scaleRdBu, firstLayer=false, minusLow=true);
createLayerAndLegend("netmob", "NETMOB_RATE", "Net internal migration rate",  "%", -30, 30, [-30, -20, -10, 0, 10, 20, 30], scaleRdBu, firstLayer=false, minusLow=true);
createLayerAndLegend("netmig", "NETMIG_RATE", "Net international migration rate",  "%", -30, 30, [-30, -20, -10, 0, 10, 20, 30], scaleRdBu, firstLayer=false, minusLow=true);
createLayerAndLegend("oldsh", "OLD_SH", "Share of elderly population",  "%", 0, 40, [0, 5, 10, 15, 20, 25, 30, 35, 40], scalePinks, firstLayer=false);
createLayerAndLegend("workagesh", "WORKAGE_SH", "Share of working age population",  "%", 30, 80, [30, 40, 50, 60, 70, 80], scalePinks, firstLayer=false,  minusLow=true);
createLayerAndLegend("youngsh", "YOUTH_SH", "Share of young population",  "%", 0, 30, [0, 5, 10, 15, 20, 25, 30], scalePinks, firstLayer=false);
createLayerAndLegend("foreign-born", "MIGRANT_SH", "Share of foreign-born population",  "%", 0, 40, [0, 5, 10, 15, 20, 25, 30, 35, 40], scalePinks, firstLayer=false);
createLayerAndLegend("sex-ratio", "SEX_RATIO_TOT", "Sex ratio", "", 85, 115, [85, 90, 95, 100, 105, 110, 115], scaleRdBu, firstLayer=false,  minusLow=true);
createLayerAndLegend("birth", "BIRTH_RATE", "Birth rate", "births per 1000 people", 0, 25, [0, 5, 10, 15, 20, 25], scalePinks, firstLayer=false);
createLayerAndLegend("death", "DEATH_RATE", "Death rate", "deaths per 1000 people", 0, 25, [0, 5, 10, 15, 20, 25], scalePinks, firstLayer=false);

createLayerAndLegend("temp", "AIR_TEMP2M", "Average air temperature", "째C", 5, 25, [5, 10, 15, 20, 25], scaleReds, firstLayer=false,  minusLow=true);
createLayerAndLegend("temp-ch", "AIR_TEMP2M_DIFF_1981_2010", "Average air temperature change<br>compared to 1981-2010", "째C", -3, 3, [-3, -2.5, -2, -1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2, 2.5, 3], scaleBuRd, firstLayer=false, minusLow=true);
createLayerAndLegend("lst-day", "LST_DAY_SUMMER", "Summer daytime<br>surface temperature", "째C", 20, 40, [20, 25, 30, 35, 40], scaleReds, firstLayer=false,  minusLow=true);
createLayerAndLegend("lst-night", "LST_NIGHT_SUMMER", "Summer nighttime<br>surface temperature", "째C", 10, 30, [10, 15, 20, 25, 30], scaleReds, firstLayer=false,  minusLow=true);
createLayerAndLegend("cdd", "CDD_T_22C", "Cooling Degree Days", "", 0, 3000, [0, 500, 1000, 1500, 2000, 2500, 3000], scaleReds, firstLayer=false);
createLayerAndLegend("cdd-ch", "CDD_T_22C_CH", "Change in Cooling Degree Days", "", -100, 100, [-100, -80, -60, -40, -20, 0, 20, 40, 60, 80, 100], scaleBuRd, firstLayer=false, minusLow=true);
createLayerAndLegend("hdd", "HDD_T_15C", "Heating Degree Days", "", 0, 3000, [0, 500, 1000, 1500, 2000, 2500, 3000], scaleReds, firstLayer=false);
createLayerAndLegend("hdd-ch", "HDD_T_15C_CH", "Change in Heating Degree Days", "", -500, 500, [-500, -400, -300, -200, -100, 0, 100, 200, 300, 400, 500], scaleBuRd, firstLayer=false, minusLow=true);
createLayerAndLegend("hot-days", "HOT_DAYS", "Number of hot days<br>(Tmax > 35째C)", "days", 0, 30, [0, 5, 10, 15, 20, 25, 30], scaleReds, firstLayer=false);
createLayerAndLegend("hot-days-ch", "HOT_DAYS_DIFF_1981_2010", "Change in number of hot days", "days", -14, 14, [-14, -10, -6, -2, 2, 6, 10, 14], scaleBuRd, firstLayer=false, minusLow=true);
createLayerAndLegend("tropical-nights", "TROPICAL_NIGHTS", "Number of tropical nights<br>(Tmin > 20째C)", "nights", 0, 50, [0, 10, 20, 30, 40, 50], scaleReds, firstLayer=false);
createLayerAndLegend("tropical-nights-ch", "TROPICAL_NIGHTS_DIFF_1981_2010", "Change in number of tropical nights", "nights", -14, 14, [-14, -10, -6, -2, 2, 6, 10, 14], scaleBuRd, firstLayer=false, minusLow=true);
createLayerAndLegend("precip", "PRECIP_SUM", "Average annual precipitation", "mm", 0, 1500, [0, 250, 500, 750, 1000, 1250, 1500], scaleBlues, firstLayer=false);
createLayerAndLegend("precip-ch", "PRECIP_SUM_DIFF_1981_2010", "Change in annual precipitation<br>compared to 1981-2010", "mm", -100, 100, [-100, -60, -20, 20, 60, 100], scaleRdBu, firstLayer=false, minusLow=true);
createLayerAndLegend("ext-precip", "EXT_PRECIP_DAYS", "Annual extreme precipitation days", "days", 0, 50, [0, 10, 20, 30, 40, 50], scaleBlues, firstLayer=false);
createLayerAndLegend("ext-precip-ch", "EXT_PRECIP_DAYS_1981_2010", "Change in extreme precipitation days<br>compared to 1981-2010", "days", -10, 10, [-10, -6, -2, 2, 6, 10], scaleRdBu, firstLayer=false, minusLow=true);
createLayerAndLegend("drought", "SOIL_MOIST_L1_CH_1981_2018", "Soil moisture change<br>compared to 1981-2010", "%", -10, 10, [-10, -6, -2, 2, 6, 10], scaleRdBu, firstLayer=false, minusLow=true);
createLayerAndLegend("fire-burned", "FIRE_TOTAL_AREA_SH", "Share of area burned<br>in the last 5 years", "%", 0, 50, [0, 10, 20, 30, 40, 50], scaleReds, firstLayer=false);
createLayerAndLegend("river-flood", "RIVER_FLOOD_RP100_POP_SH", "Population exposure to 100-year river flooding", "%", 0, 60, [0, 10, 20, 30, 40, 50, 60], scaleReds, firstLayer=false);
createLayerAndLegend("coastal-flood", "COASTAL_FLOOD_RP100_POP_SH", "Population exposure to 100-year coastal flooding", "%", 0, 60, [0, 10, 20, 30, 40, 50, 60], scaleReds, firstLayer=false);

createLayerAndLegend("green-sh", "GREEN_AREA_SHARE", "Green area share", "%", 0, 100, [0, 20, 40, 50, 60, 70, 80, 90, 100], scaleGreens, firstLayer=false);
createLayerAndLegend("green-capita", "GREEN_AREA_CAPITA", "Green area per capita", "m짼/capita", 0, 1400, [0, 200, 400, 600, 800, 1000, 1200, 1400], scaleGreens, firstLayer=false);
createLayerAndLegend("forestch", "FOREST_CH", "Tree cover change", "%", -30, 30, [-30, -10, -5, -1, 1, 5, 10, 30], scaleRdBu, firstLayer=false, minusLow=true);
createLayerAndLegend("solar-power", "SOLAR_POWER_POT", "Photovoltaic Power Potential", "kWh/kWp", 2, 6, [2, 3, 4, 5, 6], scaleGreens, firstLayer=false,  minusLow=true);
createLayerAndLegend("wind-power", "WIND_POWER_POT", "Mean wind power density", "W/m짼", 0, 1250, [0, 250, 500, 750, 1000, 1250], scaleGreens, firstLayer=false);

// createLayerAndLegend("no2", "NO2_POP_W_MEAN", "Population exposure to NO<sub>2</sub>", "關g/m쨀", 0, 30, [0, 5, 10, 15, 20, 25, 30], scaleReds, firstLayer=false);
// createLayerAndLegend("pm25", "PM2_5_POP_W_MEAN", "Population exposure to PM2.5", "關g/m쨀", 5, 15, [5, 7.5, 10, 12.5, 15], scaleReds, firstLayer=false);
// createLayerAndLegend("pm10", "PM10_POP_W_MEAN", "Population exposure to PM10", "關g/m쨀", 0, 35, [0, 5, 10, 15, 20, 25, 30, 35], scaleReds, firstLayer=false);
// createLayerAndLegend("o3", "O3_POP_W_MEAN", "Population exposure to O<sub>3</sub>", "關g/m쨀", 40, 90, [40, 50, 60, 70, 80, 90], scaleReds, firstLayer=false);

createLayerAndLegend("download", "OOKLA_FIXED_DOWNLOAD_DEV", "Fixed download speed (deviation<br>from national average)", "%", -100, 100, [-100, -70, -40, -10, 10, 40, 70, 100], scaleRdBu, firstLayer=false, minusLow=true);
createLayerAndLegend("upload", "OOKLA_FIXED_UPLOAD_DEV", "Fixed upload speed (deviation<br>from national average)", "%", -100, 100, [-100, -70, -40, -10, 10, 40, 70, 100], scaleRdBu, firstLayer=false, minusLow=true);

var mapProvider = new window.GeoSearch.OpenStreetMapProvider();
var mapSearch = new GeoSearch.GeoSearchControl({
    provider: mapProvider,
    style: 'bar',
    // position: 'topright',
    showMarker: false,
});
map.addControl(mapSearch);

// Listen for the marker dragend event
// map.on('geosearch/showlocation', function(event) {
//     var lat = event.location.y;
//     var lon = event.location.x;
//     console.log(lat);
//     console.log(lon);
//     var clickEvent = {
//         latlng: L.latLng(lat, lon),
//         layerPoint: map.latLngToLayerPoint([lat, lon]),
//         containerPoint: map.latLngToContainerPoint([lat, lon]),
//         originalEvent: {
//             type: 'click',
//             target: map
//         }
//     };
//     map.fireEvent('click', clickEvent);
// });

</script>

</body>

</html>



